import{a as e}from"./rolldown-runtime-Cn8xt2Gj.js";import{A as t,J as n,S as r,U as i,d as a,et as o,ht as s,it as c,nt as l,ot as u,pt as d,r as f,rt as p,tt as m,v as h,w as g}from"./mui-Ec-9_KFF.js";import{a as _,o as v}from"./vendor-CfXIGJNW.js";import"./supabase-O-LofRAx.js";import{n as y}from"./index-D9FOe0EU.js";var b=e(s()),x=e(d()),S=()=>{let{id:e}=v(),s=_(),[d,S]=(0,b.useState)(null),[C,w]=(0,b.useState)(!0),[T,E]=(0,b.useState)(null),[D,O]=(0,b.useState)(!1);(0,b.useEffect)(()=>{k()},[e]);let k=async()=>{try{w(!0);let{data:t,error:n}=await y.from(`posts`).select(`*`).eq(`id`,e).eq(`estado`,`Publicado`).single();if(n)throw n;if(!t)throw Error(`Noticia no encontrada`);if(t.categoria){let{data:e}=await y.from(`secciones`).select(`nombre`).eq(`idseccion`,t.categoria).single();e&&(t.seccion_nombre=e.nombre)}S(t)}catch(e){console.error(`Error al cargar noticia:`,e),E(e.message)}finally{w(!1)}},A=e=>{if(!e)return`#808080`;let t=e.toString().toLowerCase().normalize(`NFD`).replace(/[\u0300-\u036f]/g,``),n=0;for(let e=0;e<t.length;e++)n=t.charCodeAt(e)+((n<<5)-n);let r=Math.abs(n%360),i=65+Math.abs(n)%20,a=50+Math.abs(n>>8)%15;return`hsl(${r}, ${i}%, ${a}%)`},j=e=>e?new Date(e).toLocaleDateString(`es-ES`,{day:`numeric`,month:`long`,year:`numeric`,hour:`2-digit`,minute:`2-digit`}):``,M=()=>{let e=window.location.href;navigator.share?navigator.share({title:d.titulo,text:d.subtitulo||d.titulo,url:e}).catch(()=>{navigator.clipboard.writeText(e),alert(`Enlace copiado al portapapeles`)}):(navigator.clipboard.writeText(e),alert(`Enlace copiado al portapapeles`))};return C?(0,x.jsx)(m,{className:`noticia-detalle-container`,children:(0,x.jsxs)(n,{maxWidth:`md`,sx:{py:4},children:[(0,x.jsx)(t,{variant:`rectangular`,height:400,sx:{borderRadius:2,mb:3}}),(0,x.jsx)(t,{variant:`text`,height:60}),(0,x.jsx)(t,{variant:`text`,height:40}),(0,x.jsx)(t,{variant:`text`,height:200})]})}):T||!d?(0,x.jsx)(m,{className:`noticia-detalle-container`,children:(0,x.jsxs)(n,{maxWidth:`md`,sx:{py:8,textAlign:`center`},children:[(0,x.jsx)(c,{variant:`h4`,sx:{color:`#ffd700`,mb:2},children:T||`Noticia no encontrada`}),(0,x.jsx)(o,{variant:`contained`,startIcon:(0,x.jsx)(r,{}),onClick:()=>s(`/`),sx:{background:`linear-gradient(90deg, #ffd700, #ffb200)`,color:`#000`,fontWeight:700,"&:hover":{background:`linear-gradient(90deg, #ffed4e, #ffd700)`}},children:`Volver al inicio`})]})}):(0,x.jsx)(m,{className:`noticia-detalle-container`,children:(0,x.jsxs)(n,{maxWidth:`md`,sx:{py:4},children:[(0,x.jsx)(o,{startIcon:(0,x.jsx)(r,{}),onClick:()=>s(`/`),sx:{mb:3,color:`#ffd700`,fontWeight:600,"&:hover":{backgroundColor:`rgba(255, 215, 0, 0.1)`}},children:`Volver`}),d.imagen&&(0,x.jsx)(m,{component:`img`,src:d.imagen,alt:d.titulo,sx:{width:`100%`,maxHeight:500,objectFit:`cover`,borderRadius:3,mb:3,boxShadow:`0 8px 32px rgba(0,0,0,0.6)`}}),d.seccion_nombre&&(0,x.jsx)(p,{icon:(0,x.jsx)(h,{}),label:d.seccion_nombre,sx:{mb:2,fontWeight:700,fontSize:`0.85rem`,backgroundColor:A(d.seccion_nombre),color:`#fff`,"& .MuiChip-icon":{color:`#fff`}}}),(0,x.jsx)(c,{variant:`h3`,sx:{color:`#ffd700`,fontWeight:800,mb:2,lineHeight:1.2,fontSize:{xs:`2rem`,md:`3rem`}},children:d.titulo}),d.subtitulo&&(0,x.jsx)(c,{variant:`h6`,sx:{color:`#c0c0c0`,fontWeight:500,mb:3,lineHeight:1.5,fontSize:{xs:`1.1rem`,md:`1.3rem`}},children:d.subtitulo}),(0,x.jsx)(i,{sx:{borderColor:`#333`,mb:3}}),(0,x.jsxs)(m,{sx:{display:`flex`,flexWrap:`wrap`,gap:3,mb:3,alignItems:`center`},children:[(0,x.jsxs)(m,{sx:{display:`flex`,alignItems:`center`,gap:1},children:[(0,x.jsx)(l,{sx:{bgcolor:`#ffd700`,color:`#000`,fontWeight:700,width:40,height:40},children:d.autor?.[0]?.toUpperCase()||`A`}),(0,x.jsxs)(m,{children:[(0,x.jsx)(c,{variant:`caption`,sx:{color:`#999`,display:`block`},children:`Autor`}),(0,x.jsx)(c,{variant:`body2`,sx:{color:`#ffd700`,fontWeight:600},children:d.autor||`Anónimo`})]})]}),(0,x.jsxs)(m,{sx:{display:`flex`,alignItems:`center`,gap:1},children:[(0,x.jsx)(g,{sx:{color:`#ffd700`,fontSize:20}}),(0,x.jsxs)(m,{children:[(0,x.jsx)(c,{variant:`caption`,sx:{color:`#999`,display:`block`},children:`Publicado`}),(0,x.jsx)(c,{variant:`body2`,sx:{color:`#c0c0c0`},children:j(d.fechacreacion)})]})]}),(0,x.jsxs)(m,{sx:{marginLeft:`auto`,display:`flex`,gap:1},children:[(0,x.jsx)(u,{onClick:()=>O(!D),sx:{color:D?`#ff4444`:`#666`,"&:hover":{color:`#ff4444`,transform:`scale(1.1)`}},children:(0,x.jsx)(a,{})}),(0,x.jsx)(u,{onClick:M,sx:{color:`#ffd700`,"&:hover":{transform:`scale(1.1)`}},children:(0,x.jsx)(f,{})})]})]}),(0,x.jsx)(i,{sx:{borderColor:`#333`,mb:4}}),(0,x.jsx)(m,{sx:{backgroundColor:`#1a1a1a`,borderRadius:3,p:4,border:`1px solid #333`},children:(0,x.jsx)(c,{sx:{color:`#e0e0e0`,fontSize:`1.1rem`,lineHeight:1.8,whiteSpace:`pre-line`,"& p":{mb:2}},children:d.contenido})}),d.fechaactualizacion&&d.fechaactualizacion!==d.fechacreacion&&(0,x.jsxs)(c,{variant:`caption`,sx:{color:`#666`,display:`block`,mt:3,textAlign:`center`},children:[`Última actualización: `,j(d.fechaactualizacion)]})]})})};export{S as default};